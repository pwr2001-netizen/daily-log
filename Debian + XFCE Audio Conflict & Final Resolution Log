# Debian + XFCE Audio Conflict & Final Resolution Log  
(PulseAudio â†’ PipeWire)

## ğŸ“Œ Environment
- **OS:** Debian  
- **Desktop:** XFCE  
- **Final Audio Stack:** PipeWire + WirePlumber  
- **Output Devices:**
  - HDMI (Graphics Card)
  - SPDIF / IEC958 (Motherboard Digital)
  - Analog Stereo (ALC892)

---

## 1ï¸âƒ£ Problem Overview

**Initial symptoms:**
- System and browser audio would **work intermittently**
- `pavucontrol` showed playback, but **no actual sound**
- Output device kept switching between **IEC958 (SPDIF)** and **HDMI**
- `pactl` and `paplay` commands failed intermittently

---

## 2ï¸âƒ£ Root Cause During PulseAudio Stage

### Main causes
- PulseAudio was running in **mixed modes**:
  - `systemd --user` managed instance
  - legacy autospawn instance
- HDMI / IEC958 / Analog outputs constantly switched
- **Default sink became inconsistent and corrupted**

### Typical symptoms
- `pulseaudio --start` failed
- `pactl info` returned connection refused
- Sound sometimes worked, but control tools did not

### Conclusion
> **The PulseAudio daemon state was corrupted due to repeated restarts and mixed execution methods.**

---

## 3ï¸âƒ£ Strategy Change: Switching to PipeWire

Instead of repairing PulseAudio, the decision was made to **migrate to PipeWire**.

### Why PipeWire
- Full PulseAudio compatibility (`pipewire-pulse`)
- More stable handling of HDMI and analog outputs
- Near-standard setup for Debian + XFCE

---

## 4ï¸âƒ£ PipeWire Installation & Migration

```bash
sudo apt purge pulseaudio pulseaudio-utils
sudo apt autoremove

sudo apt install pipewire pipewire-pulse wireplumber pavucontrol
Enable and start services:

bash
ì½”ë“œ ë³µì‚¬
systemctl --user enable pipewire pipewire-pulse wireplumber
systemctl --user start pipewire pipewire-pulse wireplumber
Verify:

bash
ì½”ë“œ ë³µì‚¬
pactl info
# Server Name: PulseAudio (on PipeWire)
5ï¸âƒ£ Final Issue: Wrong Output Sink
Even after switching to PipeWire, no sound was heard.

Cause
SPDIF (IEC958) was in RUNNING state

Actual speakers were connected via HDMI

The wrong default sink was selected

Check available sinks
bash
ì½”ë“œ ë³µì‚¬
pactl list short sinks
Example output:

text
ì½”ë“œ ë³µì‚¬
alsa_output.pci-0000_00_03.0.hdmi-stereo
alsa_output.pci-0000_00_1b.0.iec958-stereo
6ï¸âƒ£ Decisive Fix (Critical Command)
bash
ì½”ë“œ ë³µì‚¬
pactl set-default-sink alsa_output.pci-0000_00_03.0.hdmi-stereo
ğŸ‘‰ Locks the graphics card HDMI audio as the system default output.

Immediate results:

Browser audio works

System sounds work

speaker-test works correctly

7ï¸âƒ£ Final System State (Ending)
âœ… PipeWire + WirePlumber running normally
âœ… HDMI audio fixed as default output
âœ… SPDIF / IEC958 conflict eliminated
âœ… Stable under XFCE
âœ… Persists after reboot

ğŸ§  Key Lesson
The real problem was not whether sound existed, but
where the sound was being sent (the Sink).

HDMI â‰  SPDIF â‰  Analog

Linux does not auto-correct this reliably

Explicitly setting the default sink solves everything

ğŸ Final Summary
In a Debian + XFCE environment, PulseAudio-based audio conflicts caused
HDMI and IEC958 outputs to become misaligned, resulting in no sound.
After migrating from PulseAudio to PipeWire and explicitly setting:
